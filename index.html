<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>table task</title>

        <style>
            *,
            *::before,
            *::after {
                box-sizing: border-box;
            }

            /* _______START NORMALIZE________ */
            html,
            body,
            h1,
            h2,
            h3,
            h4,
            h5,
            h6,
            p,
            blockquote,
            figure,
            ol,
            ul {
                margin: 0;
                padding: 0;
            }

            html {
                line-height: 1.15;
                -webkit-text-size-adjust: 100%;
            }

            ul,
            ol {
                list-style: none;
            }

            img {
                max-width: 100%;
                height: auto;
                display: block;
            }

            /* Remove underlines from links */
            a {
                text-decoration: none;
            }
            /* ___________END NORMALIZE___________ */

            /* BASIC STYLES  */
            body {
                font-size: 16px;
                line-height: 1.6;
                background-color: #f7f7f7;
                font-family: Arial, sans-serif;
                padding: 50px 0;
            }

            .l-wrapper {
                max-width: 1440px;
                padding: 0 40px;
                margin: 0 auto;
                width: 100%;
            }
            .l-schedule__container {
                /* width: 100%; */
                /* overflow: hidden; */
                overflow-x: auto;
            }
            .l-schedule {
                display: flex;
                position: relative;
                /* gap: 10px; */
                overflow: hidden;
                padding-top: 40px;
                min-width: 1200px;
                /* overflow-x: scroll; */
            }

            .l-times-block .l-time {
                height: 30px;
            }
            .l-times__lines {
                position: absolute;
                min-width: 100%;
                height: 100%;
                top: 0;
                left: 0;
            }
            .l-times-block {
                padding-right: 10px;
                background-color: white;
            }
            .l-time {
                background-color: white;
                z-index: 2;
            }
            .l-time::after {
                content: "";
                border-bottom: 1px solid #ddd;
                position: absolute;
                width: 100%;
                left: 0;
                margin-top: 12px;
                pointer-events: none;
                z-index: -1;
            }

            .l-days {
                display: flex;
                flex: 1;
                border-left: 1px solid #ddd;
                border-right: 0;
                /* border-bottom: 1px solid #ddd; */
                position: relative;
            }
            .day {
                flex: 1;
                border-right: 1px solid #ddd;
                position: relative;
                min-height: 600px; /* Задайте минимальную высоту по вашему усмотрению */
            }
            .day .day-title {
                position: absolute;
                top: -30px;
                text-align: center;
                width: 100%;
            }
            .l-event {
                position: absolute;
                left: 0;
                right: 0;
                background-color: rgb(247, 111, 0);
                /* border: 1px solid #ccc; */
                overflow: hidden;
                padding: 4px;
                border-radius: 6px;
            }

            .l-event__title {
                font-weight: bold;
                display: flex;
                line-height: normal;
            }
        </style>
    </head>
    <body>
        <main>
            <div class="l-wrapper">
                <div class="l-schedule__container">
                    <div class="l-schedule">
                        <div class="l-times">
                            <div class="l-times-block"></div>
                            <!-- <div class="l-times__lines"></div> -->
                        </div>
                        <div class="l-days">
                            <div class="day" data-day="Пн">
                                <span class="day-title">Пн</span>
                            </div>
                            <div class="day" data-day="Вт">
                                <span class="day-title">Вт</span>
                            </div>
                            <div class="day" data-day="Ср">
                                <span class="day-title">Ср</span>
                            </div>
                            <div class="day" data-day="Чт">
                                <span class="day-title">Чт</span>
                            </div>
                            <div class="day" data-day="Пт">
                                <span class="day-title">Пт</span>
                            </div>
                            <div class="day" data-day="Сб">
                                <span class="day-title">Сб</span>
                            </div>
                            <div class="day" data-day="Вс">
                                <span class="day-title">Вс</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <script>
            window.addEventListener("DOMContentLoaded", () => {
                // данные в массиве обязательно должны быть заполнены как на примере!!!
                //
                //  время должно быть указано в формате "HH:MM - HH:MM"
                //  HH - часы, MM - минуты
                //  пример: "08:30 - 19:00", "15:00 - 16:00"
                //
                // Дни недели укороченный варинат по типу Пн Вт Чт, прошу учесть регистр!!!
                const events = [
                    { time: "08:30 - 19:00", day: "Пн", className: "ТЕСТ2", instructor: "Фамилия2 Имя2" },
                    { time: "15:00 - 16:00", day: "Вт", className: "ТЕСТ", instructor: "Фамилия Имя" },
                    { time: "11:30 - 16:00", day: "Чт", className: "ТЕСТ", instructor: "Фамилия Имя" },
                    { time: "11:30 - 16:00", day: "Чт", className: "ТЕСТ", instructor: "Фамилия Имя" },
                    { time: "09:00 - 12:00", day: "Вс", className: "ТЕСТ", instructor: "Фамилия Имя" },
                    {
                        time: "11:00 - 14:00",
                        day: "Вт",
                        className: "Длинное название названиеназвание",
                        instructor: "Фамилия Имя",
                    },
                    {
                        time: "11:00 - 11:30",
                        day: "Пт",
                        className: "Длинное название названиеназвание",
                        instructor: "Фамилия Имя",
                    },
                    {
                        time: "12:00 - 14:30",
                        day: "Пт",
                        className: "Длинное название названиеназвание",
                        instructor: "Фамилия Имя",
                    },
                ];

                // Функция для создания временного интервала
                function createTimeIntervals() {
                    const timeContainer = document.querySelector(".l-times-block");
                    if (!timeContainer) return;
                    let startTime = new Date("1970-01-01T08:00:00"); //08:00:00
                    let endTime = new Date("1970-01-01T22:00:00");

                    // Шаг времени в минутах (30 минут)
                    let step = 30;

                    // Пока текущее время меньше конечного времени
                    while (startTime <= endTime) {
                        let timeString = startTime.toTimeString().substring(0, 5); // Преобразуем время в строку "HH:MM"

                        // Создаем новый div для текущего времени
                        const timeDiv = document.createElement("div");
                        timeDiv.setAttribute("data-time", timeString);
                        timeDiv.classList.add("l-time");
                        timeDiv.textContent = timeString;

                        // Добавляем div в контейнер
                        timeContainer.appendChild(timeDiv);

                        // Увеличиваем текущее время на 30 минут
                        startTime.setMinutes(startTime.getMinutes() + step);
                    }
                }

                // Вызов функции для отображения интервалов
                createTimeIntervals();

                function parseTime(timeStr) {
                    const [start, end] = timeStr.split(" - ").map((t) => new Date(`1970-01-01T${t}:00Z`));
                    return { start, end };
                }

                function convertTimeToPixels(time) {
                    const hours = time.getUTCHours();
                    const minutes = time.getUTCMinutes();
                    return (hours - 7.8) * 60 + minutes; // 7.8 - смещение
                }

                function getTimeCoordinate(timeStr) {
                    const { start, end } = parseTime(timeStr);
                    return {
                        startY: convertTimeToPixels(start),
                        endY: convertTimeToPixels(end),
                    };
                }

                function createEventElement(event) {
                    const { startY, endY } = getTimeCoordinate(event.time);
                    const height = endY - startY;

                    const eventElem = document.createElement("div");
                    eventElem.classList.add("l-event");
                    eventElem.style.top = `${startY}px`;
                    eventElem.style.height = `${height}px`;
                    eventElem.innerHTML = `<span class="l-event__title">${event.className}</span>${event.instructor}<br>${event.time}`;

                    return eventElem;
                }

                function renderEvents() {
                    events.forEach((event) => {
                        const dayElem = document.querySelector(`.day[data-day="${event.day}"]`);
                        if (dayElem) {
                            const eventElem = createEventElement(event);
                            dayElem.appendChild(eventElem);
                        }
                    });
                }

                renderEvents();
            });
        </script>
    </body>
</html>
